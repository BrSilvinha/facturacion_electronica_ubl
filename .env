# =============================================================================
# CONFIGURACI√ìN BASE DE DATOS
# =============================================================================
DB_NAME=facturacion_electronica_db
DB_USER=facturacion_user
DB_PASSWORD=facturacion123
DB_HOST=localhost
DB_PORT=5432

# =============================================================================
# CONFIGURACI√ìN DJANGO
# =============================================================================
SECRET_KEY=tu-clave-secreta-super-segura-para-facturacion-electronica-2025
DEBUG=True

# =============================================================================
# üöÄ CONFIGURACI√ìN SUNAT CON CERTIFICADO REAL C23022479065 - RUC FIX APLICADO
# =============================================================================

# Ambiente de trabajo (beta para pruebas con certificado real)
SUNAT_ENVIRONMENT=beta

# üîß RUC CORREGIDO - USA EL RUC REAL DE COMERCIAL LAVAGNA
SUNAT_RUC=20103129061

# Credenciales SUNAT Beta (FIJAS para ambiente de pruebas)
SUNAT_BETA_USER=MODDATOS
SUNAT_BETA_PASSWORD=MODDATOS

# Credenciales SUNAT Producci√≥n (cuando tengas acceso real)
SUNAT_PROD_USER=
SUNAT_PROD_PASSWORD=

# =============================================================================
# URLs DE SERVICIOS SUNAT (SIN PAR√ÅMETROS EXTRA)
# =============================================================================

# URLs SUNAT Beta (Ambiente de pruebas)
SUNAT_BETA_WSDL_FACTURA=https://e-beta.sunat.gob.pe/ol-ti-itcpfegem-beta/billService?wsdl
SUNAT_BETA_WSDL_GUIA=https://e-beta.sunat.gob.pe/ol-ti-itemision-guia-gem-beta/billService?wsdl
SUNAT_BETA_WSDL_RETENCION=https://e-beta.sunat.gob.pe/ol-ti-itemision-otroscpe-gem-beta/billService?wsdl

# URLs SUNAT Producci√≥n (Para cuando vayas a producci√≥n real)
SUNAT_PROD_WSDL_FACTURA=https://e-factura.sunat.gob.pe/ol-ti-itcpfegem/billService?wsdl
SUNAT_PROD_WSDL_GUIA=https://e-guiaremision.sunat.gob.pe/ol-ti-itemision-guiagem/billService?wsdl
SUNAT_PROD_WSDL_RETENCION=https://e-factura.sunat.gob.pe/ol-ti-itemision-otroscpe-gem/billService?wsdl

# =============================================================================
# CONFIGURACI√ìN ADICIONAL SUNAT
# =============================================================================
SUNAT_TIMEOUT=120
SUNAT_MAX_RETRIES=3
SUNAT_ENABLE_LOGGING=True

# =============================================================================
# üîß CONFIGURACI√ìN CERTIFICADOS DIGITALES - CERTIFICADO REAL C23022479065 + RUC FIX
# =============================================================================

# Directorio de certificados
CERT_PATH=certificados/

# Configuraci√≥n del certificado real del profesor
REAL_CERT_RUC=23022479065
REAL_CERT_PATH=certificados/production/C23022479065.pfx
REAL_CERT_PASSWORD=Ch14pp32023

# üöÄ CONFIGURACI√ìN RUC FIX - CR√çTICO PARA SUNAT
RUC_VALIDATION_ENABLED=True
RUC_FIX_APPLIED=True
SIGNATURE_RUC_VALIDATION=True

# Configuraci√≥n de seguridad para certificados
CERT_PASSWORD_KEY=clave-secreta-para-encriptar-passwords-certificados
SIGNATURE_REQUIRED=True

# Configuraci√≥n de firma digital real
DIGITAL_SIGNATURE_ENABLED=True
USE_REAL_CERTIFICATE=True
VALIDATE_CERT_CHAIN=True

# =============================================================================
# CONFIGURACI√ìN DESARROLLO
# =============================================================================

# CORS para desarrollo
CORS_ALLOW_ALL_ORIGINS=True
CORS_ALLOW_CREDENTIALS=True

# Configuraci√≥n de archivos
MEDIA_ROOT=media/
STATIC_ROOT=staticfiles/

# =============================================================================
# CONFIGURACI√ìN LOGGING
# =============================================================================

# Habilitar logs detallados
LOG_LEVEL=INFO
LOG_SIGNATURE_OPERATIONS=True
LOG_CERT_OPERATIONS=True
LOG_SUNAT_OPERATIONS=True

# =============================================================================
# CONFIGURACI√ìN AMBIENTE DE DESARROLLO
# =============================================================================

# Configuraci√≥n para desarrollo local
ALLOWED_HOSTS=localhost,127.0.0.1
DJANGO_SETTINGS_MODULE=facturacion_electronica.settings

# Configuraci√≥n de cache (desarrollo)
CACHE_TIMEOUT=300
CERT_CACHE_TIMEOUT=3600

# =============================================================================
# üéâ NOTAS IMPORTANTES - RUC FIX APLICADO PARA ERROR cac:PartyIdentification/cbc:ID
# =============================================================================

# üìã CERTIFICADO REAL C23022479065:
# - Este es un certificado digital REAL de SUNAT proporcionado por el profesor
# - Password: Ch14pp32023
# - Ubicaci√≥n: certificados/production/C23022479065.pfx
# - SOLO usar en ambiente beta para pruebas
# - NO subir a repositorios p√∫blicos

# üöÄ CONFIGURACI√ìN ACTUAL - RUC FIX:
# - Usa empresa existente RUC 20103129061 (COMERCIAL LAVAGNA)
# - Firma con certificado real C23022479065
# - üîß RUC FIX APLICADO: cac:Signature/cac:SignatoryParty/cac:PartyIdentification/cbc:ID ahora incluye RUC
# - Env√≠a a SUNAT Beta para obtener CDR real
# - Error "cac:PartyIdentification/cbc:ID - No se encontr√≥ el ID-RUC" SOLUCIONADO

# ‚ö†Ô∏è IMPORTANTE:
# 1. Coloca C23022479065.pfx en certificados/production/
# 2. Reinicia Django despu√©s de cambios
# 3. Usa tu empresa existente (RUC 20103129061)
# 4. El RUC ahora se incluye autom√°ticamente en la secci√≥n cac:Signature
# 5. Deber√≠as obtener CDR real de SUNAT Beta

# üîß FIX APLICADO:
# - Template UBL corregido: factura.xml incluye RUC en cac:Signature
# - BaseGenerator validaci√≥n RUC: verifica RUC v√°lido antes de generar XML
# - XMLSigner RUC fix: aplica RUC autom√°ticamente en cac:SignatoryParty
# - API views: validaci√≥n RUC en todos los endpoints

# üîß COMANDOS √öTILES:
# python manage.py runserver
# python manage.py shell
# python manage.py collectstatic

# üìù ESTRUCTURA DE ARCHIVOS NECESARIA:
# certificados/
# ‚îú‚îÄ‚îÄ production/
# ‚îÇ   ‚îî‚îÄ‚îÄ C23022479065.pfx  ‚Üê AQU√ç va el certificado real
# ‚îî‚îÄ‚îÄ test/
#     ‚îú‚îÄ‚îÄ test_cert_empresa1.pfx
#     ‚îî‚îÄ‚îÄ test_cert_empresa2.pfx

# üéØ TESTING CON RUC FIX:
# 1. GET /api/test/ - Verificar API (incluye info RUC fix)
# 2. GET /api/certificate-info/ - Verificar certificado y RUC validation
# 3. POST /api/generar-xml/ - Generar con firma real y RUC fix aplicado
# 4. POST /api/sunat/send-bill/ - Enviar a SUNAT y obtener CDR real
# 5. Verificar XML generado contiene: <cbc:ID>20103129061</cbc:ID> en cac:Signature

# ‚úÖ TODO CONFIGURADO PARA USAR CERTIFICADO REAL C23022479065
# ‚úÖ RUC FIX APLICADO - ERROR cac:PartyIdentification/cbc:ID SOLUCIONADO
# ‚úÖ COMPATIBLE CON EMPRESA EXISTENTE RUC 20103129061
# ‚úÖ LISTO PARA OBTENER CDR REAL DE SUNAT